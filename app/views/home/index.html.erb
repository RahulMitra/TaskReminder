<div class="container">

  <!-- hero unit -->
  <div class="hero-unit" style = "padding-top: 20px; width: 950px;">
    <h1 style = "font-size: 80px">Tasks:</h1>
	<hr/>
	<br/>
	<table cellspacing="5" cellpadding="20">
		
		<!-- sort the activities according to priority of when they are due -->
		<% sorted_activities = @activities.sort { |a,b| (Time.now.getlocal.to_date.mjd - b.time.mjd) - b.time_out <=>
														(Time.now.getlocal.to_date.mjd - a.time.mjd) - a.time_out } %>
 		<% sorted_activities.each do |activity| %>
			<%= render :partial => 'create_row', :locals => {:activity => activity} %>
		<% end %>
	</table>
	</div>

<script>
	document.getElementById("home").className = "active"
	
	$(function()
	{
		$('.datepick').each(function()	
		{
		    $(this).datepicker();
			
			$(this).datepicker().on('changeDate', function(ev)
			{
				$(this).datepicker('hide');
			});
		});
	});
</script>

<script src="http://js.pusher.com/1.12/pusher.min.js"></script>
<script type="text/javascript">
	var pusher = new Pusher('<%= Pusher.key %>');
  	var channel = pusher.subscribe('taskreminder');
  	channel.bind('update', function(data)
	{
		location.reload();
		//newRow = "<tr><td>sdfsdf</td><td>sdfsdf</td><td>sdfsdf</td></tr>";
		//newRow = "<tr><td>"+ data.one +"</td>" + "<td>" + data.two + "</td>" + "<td>" + data.three "</td></tr>";
		//$('#rowid3').replaceWith(newRow);
  	});
</script>